// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model COApiConfigurations {
  id                   Int @id @default(autoincrement())
  openrouterApiKey     String? @map("openrouter_api_key")
  geminiApiKey         String? @map("gemini_api_key")
  firecrawlApiKey      String? @map("firecrawl_api_key")
  proxycurlApiKey      String? @map("proxycurl_api_key")
  industryMappings     Json? @map("industry_mappings")
  isActive             Boolean @default(true) @map("is_active")
  createdAt            DateTime @default(now()) @default(now()) @map("created_at")
  updatedAt            DateTime @updatedAt @map("updated_at")
  defaultSignature     String? @map("default_signature")
  personalEmailDomains String? @map("personal_email_domains")
  geminiTemperature    Float? @map("gemini_temperature")
  geminiMaxOutputTokens Int? @map("gemini_max_output_tokens")
  timeoutSeconds       Int? @map("timeout_seconds")
  maxRetries           Int? @map("max_retries")
  domainKeywordsIndustry String? @map("domain_keywords_industry")

  @@map("CO_api_configurations")
}

model COAutoServiceSettings {
  id                   Int @id @default(autoincrement())
  description          String?
  promptTemplate       String? @map("prompt_template")
  createdAt            DateTime? @default(now()) @map("created_at")
  updatedAt            DateTime? @updatedAt @map("updated_at")

  @@map("CO_auto_service_settings")
}

model COBatches {
  id                   Int @id @default(autoincrement())
  campaignId           Int @map("campaign_id")
  name                 String
  status               String
  totalProspects       Int @map("total_prospects")
  enrichedProspects    Int @map("enriched_prospects")
  generatedEmails      Int @map("generated_emails")
  failedProspects      Int @map("failed_prospects")
  errorMessage         String? @map("error_message")
  createdAt            DateTime @default(now()) @default(now()) @map("created_at")
  updatedAt            DateTime @updatedAt @map("updated_at")
  cOCampaigns          COCampaigns? @relation(fields: [campaignId], references: [id])

  @@map("CO_batches")
}

model COCampaigns {
  id                   Int @id @default(autoincrement())
  name                 String
  emailSubject         String? @map("email_subject")
  prompt               String?
  enrichmentFlags      Json? @map("enrichment_flags")
  serviceId            Int? @map("service_id")
  createdAt            DateTime @default(now()) @default(now()) @map("created_at")
  updatedAt            DateTime @updatedAt @map("updated_at")

  @@map("CO_campaigns")
}

model COGeneratedEmails {
  prospectId           Int @id @map("prospect_id")
  subject              String?
  body                 String?
  generationStatus     String @map("generation_status")
  errorMessage         String? @map("error_message")
  createdAt            DateTime @default(now()) @default(now()) @map("created_at")
  updatedAt            DateTime @updatedAt @map("updated_at")
  language             String?
  generatedAt          DateTime? @map("generated_at")
  modelUsed            String? @map("model_used")
  generationMetadata   Json? @map("generation_metadata")
  cOProspects          COProspects? @relation(fields: [prospectId], references: [id])

  @@map("CO_generated_emails")
}

model COPrompts {
  id                   Int @id @default(autoincrement())
  companySummaryPrompt String? @map("company_summary_prompt")
  linkedinSummaryPrompt String? @map("linkedin_summary_prompt")
  techStackPrompt      String? @map("tech_stack_prompt")
  prospectAnalysisPrompt String? @map("prospect_analysis_prompt")
  isActive             Boolean @default(true) @map("is_active")
  version              String?
  description          String?
  createdAt            DateTime @default(now()) @default(now()) @map("created_at")
  updatedAt            DateTime @default(now()) @updatedAt @map("updated_at")

  @@map("CO_prompts")
}

model COProspectEnrichments {
  prospectId           Int @id @map("prospect_id")
  companyWebsite       String? @map("company_website")
  companySummary       String? @map("company_summary")
  linkedinSummary      String? @map("linkedin_summary")
  prospectAnalysisSummary String? @map("prospect_analysis_summary")
  techStack            Json? @map("tech_stack")
  enrichmentStatus     String @map("enrichment_status")
  createdAt            DateTime @default(now()) @default(now()) @map("created_at")
  updatedAt            DateTime @updatedAt @map("updated_at")
  builtwithSummary     String? @map("builtwith_summary")
  enrichedAt           DateTime? @map("enriched_at")
  modelUsed            String? @map("model_used")
  cOProspects          COProspects? @relation(fields: [prospectId], references: [id])

  @@map("CO_prospect_enrichments")
}

model COProspects {
  id                   Int @id @default(autoincrement())
  campaignId           Int @map("campaign_id")
  batchId              Int? @map("batch_id")
  name                 String?
  email                String
  company              String?
  position             String?
  linkedinUrl          String? @map("linkedin_url")
  status               String
  additionalData       Json? @map("additional_data")
  errorMessage         String? @map("error_message")
  createdAt            DateTime @default(now()) @default(now()) @map("created_at")
  updatedAt            DateTime @updatedAt @map("updated_at")
  jobTitle             String? @map("job_title")
  phone                String?
  location             String?
  companyEmployees     String? @map("company_employees")
  companyIndustries    String? @map("company_industries")
  companyKeywords      String? @map("company_keywords")
  usesFallback         Boolean? @default(false) @map("uses_fallback")
  cOCampaigns          COCampaigns? @relation(fields: [campaignId], references: [id])
  cOBatches            COBatches? @relation(fields: [batchId], references: [id])

  @@map("CO_prospects")
}

model COServices {
  id                   Int @id @default(autoincrement())
  name                 String
  isActive             Boolean @default(true) @map("is_active")
  createdAt            DateTime @default(now()) @default(now()) @map("created_at")
  updatedAt            DateTime @updatedAt @map("updated_at")
  promptTemplate       String? @map("prompt_template")

  @@map("CO_services")
}

model COWorkflowSessions {
  id                   String @id
  userSessionId        String @map("user_session_id")
  campaignId           Int? @map("campaign_id")
  currentStep          String @map("current_step")
  status               String
  configurationData    Json? @map("configuration_data")
  stepsCompleted       Json? @map("steps_completed")
  errorMessage         String? @map("error_message")
  createdAt            DateTime @default(now()) @default(now()) @map("created_at")
  updatedAt            DateTime @updatedAt @map("updated_at")
  cOCampaigns          COCampaigns? @relation(fields: [campaignId], references: [id])

  @@map("CO_workflow_sessions")
}

model Profiles {
  id                   Int @id @default(autoincrement())
  name                 String
  apiKey               String? @map("api_key")
  temperature          String?
  maxTokens            String? @map("max_tokens")
  topK                 String? @map("top_k")
  topP                 String? @map("top_p")
  maxEmailHistory      String? @map("max_email_history")
  emailHistoryMaxLength String? @map("email_history_max_length")
  customPrompt         String? @map("custom_prompt")
  isActive             Boolean? @map("is_active")
  createdAt            DateTime? @default(now()) @map("created_at")
  updatedAt            DateTime? @updatedAt @map("updated_at")

  @@map("profiles")
}

